<?xml version="1.0" encoding="UTF-8"?>
<DataService xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../DataService.xsd">
	
	<!-- 新增数据字典 -->
	<SQLTrans TransFlag="1" TransName="saveDictionarys" DataGroupId="writeSystem">
		<For Count="{dicts.length}" FromIndex="0" IndexId="{i}">
			<Insert>
				<OutputSQL>insert into dictionary(dictCode,dictName,dictKey,dictValue,dictDesc,createTime) values({dicts[i].dictCode},{dicts[i].dictName},{dicts[i].dictKey},{dicts[i].dictValue},{dicts[i].dictDesc|''},{currentTime})</OutputSQL>
			</Insert>
		</For>
		<OnException>
			<Return Code="-1" Info="新增数据字典数据库异常" Text="新增数据字典数据库异常"/>
		</OnException>
		<Return Code="0" Info="新增数据字典成功" Text="新增数据字典成功"/>
	</SQLTrans>
	
	<SQLTrans TransFlag="1" TransName="updateDictionary" DataGroupId="writeSystem">
		<Update>
			<OutputSQL>update dictionary set dictName={dictName},dictCode={dictCode},dictKey={dictKey},dictValue={dictValue},dictDesc={dictDesc|''},status={status} where id={id}</OutputSQL>
		</Update>
		<OnException>
			<Return Code="-1" Info="修改数据字典数据库异常" Text="修改数据字典数据库异常"/>
		</OnException>
		<Return Code="0" Info="修改数据字典成功" Text="修改数据字典成功"/>
	</SQLTrans>	
	
	<!-- 分页查询数据字典 -->
	<SQLTrans TransFlag="0" TransName="queryPage" DataGroupId="readSystem" >
		<SelectField OutputId="{totalCount}">
			<OutputSQL>select count(*) from dictionary where 1=1 </OutputSQL>
			<SQLIf Value1="{dictName}" Type="String" Operator="EXIST">
				<SQLThen><OutputSQL>  and dictName like '%{r:dictName}%'</OutputSQL></SQLThen>
			</SQLIf>
		</SelectField>
		<SelectRecordSet OutputId="{dictionarys}">
			<OutputSQL>select * from dictionary where 1=1 </OutputSQL>
			<SQLIf Value1="{dictName}" Type="String" Operator="EXIST">
				<SQLThen><OutputSQL>  and dictName like '%{r:dictName}%'</OutputSQL></SQLThen>
			</SQLIf>	
			<OutputSQL> limit {startIndex},{pageSize}</OutputSQL>
		</SelectRecordSet>
		<OnException>
			<Return Code="-1" Text="查询数据字典信息异常" Info="DictionaryService.xml.queryPage(i)"></Return>
		</OnException>
		<Return Code="0" Text="查询数据字典信息成功" Info="查询数据字典信息成功">
			<ReturnItem FieldId="{pageNumber}" ValueId="{pageNumber}"/>
			<ReturnItem FieldId="{pageSize}" ValueId="{pageSize}"/>
			<ReturnItem FieldId="{totalCount}" ValueId="{totalCount}"/>
			<ReturnItem FieldId="{list}" ValueId="{dictionarys}"/>
		</Return>
	</SQLTrans>	
	
	<SQLTrans TransFlag="0" TransName="queryDictionaryById" DataGroupId="readSystem" >
		<SelectRecord OutputId="{dictionary}">
			<OutputSQL>select * from dictionary where id={id} </OutputSQL>
		</SelectRecord>
		<OnException>
			<Return Code="-1" Text="查询数据字典异常" Info="DictionaryService.xml.queryById(i)"></Return>
		</OnException>
		<Return Code="0" Text="查询数据字典成功" Info="查询数据字典成功">
			<ReturnItem FieldId="{dictionary}" ValueId="{dictionary}"/>
		</Return>
	</SQLTrans>		
	
	<SQLTrans TransFlag="0" TransName="queryDictionaryByUser" DataGroupId="readSystem" >
		<SelectRecordSet OutputId="{dictionarys}">
			<OutputSQL>select * from userDictionary where userId={empNo} and status=1</OutputSQL>
		</SelectRecordSet>
		<OnException>
			<Return Code="-1" Text="查询Admins信息异常" Info="AdminsService.xml.queryMenuByUser(i)"></Return>
		</OnException>
		<Return Code="0" Text="查询Admins信息成功" Info="查询Admins信息成功">
			<ReturnItem FieldId="{list}" ValueId="{dictionarys}"/>
		</Return>
	</SQLTrans>	
</DataService>